<frozen runpy>:128: RuntimeWarning: 'models.cnn.train' found in sys.modules after import of package 'models.cnn', but prior to execution of 'models.cnn.train'; this may result in unpredictable behaviour
============================================================
CNN MODEL TRAINING
============================================================
Device: cpu

Loading data from: data/molecular_comm_dataset.mat
Total samples: 5000
Heatmap shape: (100, 100)
Train: 3500, Val: 750, Test: 750

Model parameters: 33,890

============================================================
Training started
============================================================
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   1%|          | 1/100 [00:12<20:29, 12.42s/it]Training:   2%|▏         | 2/100 [00:24<20:09, 12.34s/it]Training:   3%|▎         | 3/100 [00:36<19:54, 12.32s/it]Training:   4%|▍         | 4/100 [00:49<19:52, 12.43s/it]Training:   5%|▌         | 5/100 [01:02<19:41, 12.44s/it]Training:   6%|▌         | 6/100 [01:14<19:31, 12.47s/it]Training:   7%|▋         | 7/100 [01:27<19:25, 12.53s/it]Training:   8%|▊         | 8/100 [01:40<19:24, 12.66s/it]Training:   9%|▉         | 9/100 [01:52<19:07, 12.61s/it]                                                         Training:   9%|▉         | 9/100 [02:06<19:07, 12.61s/it]Training:  10%|█         | 10/100 [02:06<19:15, 12.84s/it]Training:  11%|█         | 11/100 [02:18<18:44, 12.63s/it]Training:  12%|█▏        | 12/100 [02:30<18:26, 12.57s/it]Training:  13%|█▎        | 13/100 [02:43<18:15, 12.59s/it]Training:  14%|█▍        | 14/100 [02:55<18:01, 12.57s/it]Training:  15%|█▌        | 15/100 [03:08<17:48, 12.57s/it]Training:  16%|█▌        | 16/100 [03:20<17:36, 12.58s/it]Training:  17%|█▋        | 17/100 [03:34<17:38, 12.76s/it]Training:  18%|█▊        | 18/100 [03:46<17:28, 12.79s/it]Training:  19%|█▉        | 19/100 [03:59<17:12, 12.74s/it]                                                          Training:  19%|█▉        | 19/100 [04:12<17:12, 12.74s/it]Training:  20%|██        | 20/100 [04:12<17:08, 12.86s/it]Training:  21%|██        | 21/100 [04:25<16:41, 12.68s/it]Training:  22%|██▏       | 22/100 [04:37<16:23, 12.60s/it]Training:  23%|██▎       | 23/100 [04:49<16:06, 12.55s/it]Training:  24%|██▍       | 24/100 [05:02<15:50, 12.50s/it]Training:  25%|██▌       | 25/100 [05:14<15:33, 12.45s/it]Training:  26%|██▌       | 26/100 [05:27<15:21, 12.45s/it]Training:  27%|██▋       | 27/100 [05:39<15:04, 12.39s/it]Training:  28%|██▊       | 28/100 [05:51<14:51, 12.39s/it]Training:  29%|██▉       | 29/100 [06:04<14:41, 12.42s/it]                                                          Training:  29%|██▉       | 29/100 [06:17<14:41, 12.42s/it]Training:  30%|███       | 30/100 [06:17<14:54, 12.78s/it]Training:  31%|███       | 31/100 [06:32<15:13, 13.24s/it]Training:  32%|███▏      | 32/100 [06:45<15:01, 13.26s/it]Training:  33%|███▎      | 33/100 [06:58<14:35, 13.07s/it]Training:  34%|███▍      | 34/100 [07:10<14:13, 12.93s/it]Training:  35%|███▌      | 35/100 [07:24<14:22, 13.26s/it]Training:  36%|███▌      | 36/100 [07:40<14:50, 13.92s/it]Training:  37%|███▋      | 37/100 [07:57<15:43, 14.98s/it]Training:  38%|███▊      | 38/100 [08:13<15:49, 15.31s/it]Training:  39%|███▉      | 39/100 [08:30<15:52, 15.62s/it]                                                          Training:  39%|███▉      | 39/100 [08:46<15:52, 15.62s/it]Training:  40%|████      | 40/100 [08:46<15:55, 15.92s/it]Training:  41%|████      | 41/100 [09:02<15:32, 15.80s/it]Training:  42%|████▏     | 42/100 [09:15<14:27, 14.95s/it]Training:  43%|████▎     | 43/100 [09:27<13:22, 14.08s/it]Training:  44%|████▍     | 44/100 [09:39<12:34, 13.47s/it]Training:  45%|████▌     | 45/100 [09:51<12:00, 13.10s/it]Training:  46%|████▌     | 46/100 [10:03<11:38, 12.93s/it]Training:  47%|████▋     | 47/100 [10:16<11:25, 12.94s/it]Training:  48%|████▊     | 48/100 [10:29<11:03, 12.76s/it]Training:  49%|████▉     | 49/100 [10:42<10:52, 12.79s/it]                                                          Training:  49%|████▉     | 49/100 [10:55<10:52, 12.79s/it]Training:  50%|█████     | 50/100 [10:55<10:51, 13.03s/it]Training:  51%|█████     | 51/100 [11:07<10:25, 12.76s/it]Training:  52%|█████▏    | 52/100 [11:20<10:08, 12.68s/it]Training:  53%|█████▎    | 53/100 [11:32<09:47, 12.50s/it]Training:  54%|█████▍    | 54/100 [11:44<09:29, 12.38s/it]Training:  55%|█████▌    | 55/100 [11:56<09:17, 12.39s/it]Training:  56%|█████▌    | 56/100 [12:09<09:06, 12.41s/it]Training:  57%|█████▋    | 57/100 [12:21<08:51, 12.37s/it]Training:  58%|█████▊    | 58/100 [12:33<08:37, 12.33s/it]Training:  59%|█████▉    | 59/100 [12:46<08:22, 12.25s/it]                                                          Training:  59%|█████▉    | 59/100 [12:59<08:22, 12.25s/it]Training:  60%|██████    | 60/100 [12:59<08:24, 12.62s/it]Training:  61%|██████    | 61/100 [13:11<08:10, 12.59s/it]Training:  62%|██████▏   | 62/100 [13:24<07:57, 12.56s/it]Training:  63%|██████▎   | 63/100 [13:37<07:51, 12.75s/it]Training:  64%|██████▍   | 64/100 [13:50<07:41, 12.82s/it]Training:  65%|██████▌   | 65/100 [14:02<07:22, 12.65s/it]Training:  66%|██████▌   | 66/100 [14:15<07:05, 12.51s/it]Training:  67%|██████▋   | 67/100 [14:27<06:48, 12.38s/it]Training:  68%|██████▊   | 68/100 [14:39<06:33, 12.28s/it]Training:  69%|██████▉   | 69/100 [14:51<06:21, 12.32s/it]                                                          Training:  69%|██████▉   | 69/100 [15:04<06:21, 12.32s/it]Training:  70%|███████   | 70/100 [15:04<06:16, 12.55s/it]Training:  71%|███████   | 71/100 [15:16<06:00, 12.44s/it]Training:  72%|███████▏  | 72/100 [15:28<05:45, 12.32s/it]Training:  73%|███████▎  | 73/100 [15:41<05:30, 12.24s/it]Training:  74%|███████▍  | 74/100 [15:53<05:17, 12.22s/it]Training:  75%|███████▌  | 75/100 [16:05<05:07, 12.30s/it]Training:  76%|███████▌  | 76/100 [16:17<04:54, 12.28s/it]Training:  77%|███████▋  | 77/100 [16:29<04:41, 12.22s/it]Training:  78%|███████▊  | 78/100 [16:42<04:28, 12.19s/it]Training:  79%|███████▉  | 79/100 [16:54<04:18, 12.29s/it]                                                          Training:  79%|███████▉  | 79/100 [17:07<04:18, 12.29s/it]Training:  80%|████████  | 80/100 [17:07<04:09, 12.49s/it]Training:  81%|████████  | 81/100 [17:19<03:55, 12.40s/it]Training:  82%|████████▏ | 82/100 [17:31<03:41, 12.29s/it]Training:  83%|████████▎ | 83/100 [17:43<03:27, 12.20s/it]Training:  84%|████████▍ | 84/100 [17:55<03:14, 12.15s/it]Training:  84%|████████▍ | 84/100 [18:07<03:27, 12.95s/it]
Epoch  10 | Val Loss: 0.052118 | MAE: 21.75μm
Epoch  20 | Val Loss: 0.046662 | MAE: 19.43μm
Epoch  30 | Val Loss: 0.046194 | MAE: 19.16μm
Epoch  40 | Val Loss: 0.017571 | MAE: 12.29μm
Epoch  50 | Val Loss: 0.010868 | MAE: 9.18μm
Epoch  60 | Val Loss: 0.009451 | MAE: 8.60μm
Epoch  70 | Val Loss: 0.009743 | MAE: 8.79μm
Epoch  80 | Val Loss: 0.010018 | MAE: 8.94μm

Early stopping at epoch 85

============================================================
Final Evaluation on Test Set
============================================================

============================================================
TEST SET METRICS
============================================================
X Coordinate:
  RMSE: 6.774 μm
  MAE:  5.171 μm
Y Coordinate:
  RMSE: 7.681 μm
  MAE:  5.940 μm
Euclidean Distance Error:
  Mean:   8.473 μm
  Median: 7.076 μm
  Std:    5.753 μm
  P90:    16.586 μm
  P95:    20.400 μm
Accuracy:
  Within 1 μm:  1.1%
  Within 2 μm:  5.2%
  Within 5 μm:  31.6%
  Within 10 μm: 69.1%
============================================================

Model saved to: outputs/cnn/model.pt
Plots saved to: outputs/cnn/training_results.png

Training complete!
